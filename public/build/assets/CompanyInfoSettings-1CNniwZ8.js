import{C as T,D as j,E as A,f as ee,e as E,g as V,F as H,l as x,h as w,i as F,Z as ae,k as J,r,o as h,n as N,w as l,b as i,t as g,m as e,a as o,q as k,H as O,I as G,s as Z,a3 as te,G as oe,c as R,p as se,L as ne}from"./main-vzIkKseS.js";const le={class:"flex justify-between w-full"},de={class:"px-6 pt-6"},re={class:"font-medium text-lg text-left"},ie={class:"mt-2 text-sm leading-snug text-gray-500",style:{"max-width":"680px"}},ue=["onSubmit"],me={class:"p-4 sm:p-6 space-y-4"},ce={class:"z-0 flex justify-end p-4 bg-gray-50 border-modal-bg"},pe={setup(K){const c=T(),v=j(),I=A(),$=ee(),{t:S}=E();let u=V(!1);const a=H({id:c.selectedCompany.id,name:null}),b=x(()=>v.active&&v.componentName==="DeleteCompanyModal"),f={formData:{name:{required:w.withMessage(S("validation.required"),F),sameAsName:w.withMessage(S("validation.company_name_not_same"),ae(c.selectedCompany.name))}}},p=J(f,{formData:a},{$scope:!1});async function B(){if(p.value.$touch(),p.value.$invalid)return!0;const y=c.companies[0];u.value=!0;try{const _=await c.deleteCompany(a);console.log(_.data.success),_.data.success&&(m(),await c.setSelectedCompany(y),$.push("/admin/dashboard"),await I.setIsAppLoaded(!1),await I.bootstrap()),u.value=!1}catch{u.value=!1}}function M(){a.id=null,a.name="",p.value.$reset()}function m(){v.closeModal(),setTimeout(()=>{M(),p.value.$reset()},300)}return(y,_)=>{const U=r("BaseInput"),q=r("BaseInputGroup"),n=r("BaseButton"),t=r("BaseIcon"),D=r("BaseModal");return h(),N(D,{show:e(b),onClose:m},{default:l(()=>[i("div",le,[i("div",de,[i("h6",re,g(e(v).title),1),i("p",ie,g(y.$t("settings.company_info.delete_company_modal_desc",{company:e(c).selectedCompany.name})),1)])]),i("form",{action:"",onSubmit:Z(B,["prevent"])},[i("div",me,[o(q,{label:y.$t("settings.company_info.delete_company_modal_label",{company:e(c).selectedCompany.name}),error:e(p).formData.name.$error&&e(p).formData.name.$errors[0].$message,required:""},{default:l(()=>[o(U,{modelValue:e(a).name,"onUpdate:modelValue":_[0]||(_[0]=d=>e(a).name=d),invalid:e(p).formData.name.$error,onInput:_[1]||(_[1]=d=>e(p).formData.name.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"])]),i("div",ce,[o(n,{class:"mr-3 text-sm",variant:"primary-outline",outline:"",type:"button",onClick:m},{default:l(()=>[k(g(y.$t("general.cancel")),1)]),_:1}),o(n,{loading:e(u),disabled:e(u),variant:"danger",type:"submit"},{left:l(d=>[e(u)?G("",!0):(h(),N(t,{key:0,name:"TrashIcon",class:O(d.class)},null,8,["class"]))]),default:l(()=>[k(" "+g(y.$t("general.delete")),1)]),_:1},8,["loading","disabled"])])],40,ue)]),_:1},8,["show"])}}},_e=["onSubmit"],fe={key:0,class:"py-5"},ye={class:"text-lg leading-6 font-medium text-gray-900"},ge={class:"mt-2 max-w-xl text-sm text-gray-500"},ve={class:"mt-5"},$e={setup(K){const c=T(),v=A(),I=j(),{t:$}=E(),S=te("utils");let u=V(!1);const a=H({name:null,logo:null,address:{address_street_1:"",address_street_2:"",website:"",country_id:null,state:"",city:"",phone:"",zip:""}});S.mergeSettings(a,{...c.selectedCompany});let b=V([]),f=V(null),p=V(null);const B=V(!1);a.logo&&b.value.push({image:a.logo});const M=x(()=>({name:{required:w.withMessage($("validation.required"),F),minLength:w.withMessage($("validation.name_min_length"),oe(3))},address:{country_id:{required:w.withMessage($("validation.required"),F)}}})),m=J(M,x(()=>a));v.fetchCountries();function y(n,t,D,d){p.value=d.name,f.value=t}function _(){f.value=null,B.value=!0}async function U(){if(m.value.$touch(),m.value.$invalid)return!0;if(u.value=!0,(await c.updateCompany(a)).data.data){if(f.value||B.value){let t=new FormData;f.value&&t.append("company_logo",JSON.stringify({name:p.value,data:f.value})),t.append("is_company_logo_removed",B.value),await c.updateCompanyLogo(t),f.value=null,B.value=!1}u.value=!1}u.value=!1}function q(n){I.openModal({title:$("settings.company_info.are_you_absolutely_sure"),componentName:"DeleteCompanyModal",size:"sm"})}return(n,t)=>{const D=r("BaseFileUploader"),d=r("BaseInputGroup"),z=r("BaseInputGrid"),C=r("BaseInput"),P=r("BaseMultiselect"),L=r("BaseTextarea"),Q=r("BaseIcon"),W=r("BaseButton"),X=r("BaseDivider"),Y=r("BaseSettingCard");return h(),R(ne,null,[i("form",{onSubmit:Z(U,["prevent"])},[o(Y,{title:n.$t("settings.company_info.company_info"),description:n.$t("settings.company_info.section_description")},{default:l(()=>[o(z,{class:"mt-5"},{default:l(()=>[o(d,{label:n.$tc("settings.company_info.company_logo")},{default:l(()=>[o(D,{modelValue:e(b),"onUpdate:modelValue":t[0]||(t[0]=s=>se(b)?b.value=s:b=s),base64:"",onChange:y,onRemove:_},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),o(z,{class:"mt-5"},{default:l(()=>[o(d,{label:n.$tc("settings.company_info.company_name"),error:e(m).name.$error&&e(m).name.$errors[0].$message,required:""},{default:l(()=>[o(C,{modelValue:e(a).name,"onUpdate:modelValue":t[1]||(t[1]=s=>e(a).name=s),invalid:e(m).name.$error,onBlur:t[2]||(t[2]=s=>e(m).name.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),o(d,{label:n.$tc("settings.company_info.phone")},{default:l(()=>[o(C,{modelValue:e(a).address.phone,"onUpdate:modelValue":t[3]||(t[3]=s=>e(a).address.phone=s)},null,8,["modelValue"])]),_:1},8,["label"]),o(d,{label:n.$tc("settings.company_info.country"),error:e(m).address.country_id.$error&&e(m).address.country_id.$errors[0].$message,required:""},{default:l(()=>[o(P,{modelValue:e(a).address.country_id,"onUpdate:modelValue":t[4]||(t[4]=s=>e(a).address.country_id=s),label:"name",invalid:e(m).address.country_id.$error,options:e(v).countries,"value-prop":"id","can-deselect":!0,"can-clear":!1,searchable:"","track-by":"name"},null,8,["modelValue","invalid","options"])]),_:1},8,["label","error"]),o(d,{label:n.$tc("settings.company_info.state")},{default:l(()=>[o(C,{modelValue:e(a).address.state,"onUpdate:modelValue":t[5]||(t[5]=s=>e(a).address.state=s),name:"state",type:"text"},null,8,["modelValue"])]),_:1},8,["label"]),o(d,{label:n.$tc("settings.company_info.city")},{default:l(()=>[o(C,{modelValue:e(a).address.city,"onUpdate:modelValue":t[6]||(t[6]=s=>e(a).address.city=s),type:"text"},null,8,["modelValue"])]),_:1},8,["label"]),o(d,{label:n.$tc("settings.company_info.zip")},{default:l(()=>[o(C,{modelValue:e(a).address.zip,"onUpdate:modelValue":t[7]||(t[7]=s=>e(a).address.zip=s)},null,8,["modelValue"])]),_:1},8,["label"]),i("div",null,[o(d,{label:n.$tc("settings.company_info.address")},{default:l(()=>[o(L,{modelValue:e(a).address.address_street_1,"onUpdate:modelValue":t[8]||(t[8]=s=>e(a).address.address_street_1=s),rows:"2"},null,8,["modelValue"])]),_:1},8,["label"]),o(L,{modelValue:e(a).address.address_street_2,"onUpdate:modelValue":t[9]||(t[9]=s=>e(a).address.address_street_2=s),rows:"2",row:2,class:"mt-2"},null,8,["modelValue"])])]),_:1}),o(W,{loading:e(u),disabled:e(u),type:"submit",class:"mt-6"},{left:l(s=>[e(u)?G("",!0):(h(),N(Q,{key:0,class:O(s.class),name:"SaveIcon"},null,8,["class"]))]),default:l(()=>[k(" "+g(n.$tc("settings.company_info.save")),1)]),_:1},8,["loading","disabled"]),e(c).companies.length!==1?(h(),R("div",fe,[o(X,{class:"my-4"}),i("h3",ye,g(n.$tc("settings.company_info.delete_company")),1),i("div",ge,[i("p",null,g(n.$tc("settings.company_info.delete_company_description")),1)]),i("div",ve,[i("button",{type:"button",class:"inline-flex items-center justify-center px-4 py-2 border border-transparent font-medium rounded-md text-red-700 bg-red-100 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:text-sm",onClick:q},g(n.$tc("general.delete")),1)])])):G("",!0)]),_:1},8,["title","description"])],40,_e),o(pe)],64)}}};export{$e as default};
